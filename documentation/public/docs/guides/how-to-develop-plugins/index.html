<!doctype html><html lang=en-us dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=8081&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Carbonaut: How To Develop Plugins # Setup:
Setup your dev environment. Follow this guide. Read up the concepts documentation about provider and plugins. Identify which provider interface you need to implement:
Choose the provider which is used to implement the data you like to integrate. dynres implements energy usage, cpu frequency etc. staticres implements cloud provider, hypervisors etc. that manage your infrastructure resources. dynenv implements energy grid APIs Setup your starting point (one of these) dynres: Copy the folder pkg/plugin/dynresplugins/mockenergy and rename it to your plugins name staticres: Copy the folder pkg/plugin/staticresplugins/mockcloudplugin and rename it to your plugins name dynenv: Copy the folder pkg/plugin/dynenvplugins/mockenergymix and rename it to your plugins name Implement the provider."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://localhost:8081/docs/guides/how-to-develop-plugins/"><meta property="og:site_name" content="Carbonaut Docs"><meta property="og:title" content="Carbonaut Docs"><meta property="og:description" content="Carbonaut: How To Develop Plugins # Setup:
Setup your dev environment. Follow this guide. Read up the concepts documentation about provider and plugins. Identify which provider interface you need to implement:
Choose the provider which is used to implement the data you like to integrate. dynres implements energy usage, cpu frequency etc. staticres implements cloud provider, hypervisors etc. that manage your infrastructure resources. dynenv implements energy grid APIs Setup your starting point (one of these) dynres: Copy the folder pkg/plugin/dynresplugins/mockenergy and rename it to your plugins name staticres: Copy the folder pkg/plugin/staticresplugins/mockcloudplugin and rename it to your plugins name dynenv: Copy the folder pkg/plugin/dynenvplugins/mockenergymix and rename it to your plugins name Implement the provider."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>How to Develop Plugins | Carbonaut Docs</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=canonical href=http://localhost:8081/docs/guides/how-to-develop-plugins/><link rel=stylesheet href=/book.min.309b7ed028807cdb68d8d61e26d609f48369c098dbf5e4d8c0dcf4cdf49feafc.css integrity="sha256-MJt+0CiAfNto2NYeJtYJ9INpwJjb9eTYwNz0zfSf6vw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.75c891a37158c1b7afb5e05882626f7d7d679a123e15cde274772612caab4563.js integrity="sha256-dciRo3FYwbevteBYgmJvfX1nmhI+Fc3idHcmEsqrRWM=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo><span>Carbonaut Docs</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>Concepts</span><ul><li><a href=/docs/concepts/components/>Components</a></li><li><a href=/docs/concepts/advanced/>Advanced</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-6de00f26ce90647f7385eb3988a66aff class=toggle checked>
<label for=section-6de00f26ce90647f7385eb3988a66aff class="flex justify-between"><a role=button>Guides</a></label><ul><li><a href=/docs/guides/how-to-run/>How to Run</a></li><li><a href=/docs/guides/how-to-setup-dev-environment/>How to Setup Dev Environment</a></li><li><a href=/docs/guides/how-to-develop-internals/>How to Develop Internals</a></li><li><a href=/docs/guides/how-to-develop-plugins/ class=active>How to Develop Plugins</a></li><li><a href=/docs/guides/how-to-test-e2e/>How to Test E2E</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-b78b00acf537e50586ae380e7fd00f43 class=toggle>
<label for=section-b78b00acf537e50586ae380e7fd00f43 class="flex justify-between"><a role=button>Plugins</a></label><ul><li><input type=checkbox id=section-d0cbdedebe36dd056e11e5faab06b3c9 class=toggle>
<label for=section-d0cbdedebe36dd056e11e5faab06b3c9 class="flex justify-between"><a role=button>Static Resource</a></label><ul><li><a href=/docs/plugins/static-resource/equinix/>Equinix</a></li></ul></li><li><input type=checkbox id=section-b4ac4c3f9d54889817d33ba70b2fbcaf class=toggle>
<label for=section-b4ac4c3f9d54889817d33ba70b2fbcaf class="flex justify-between"><a role=button>Dynamic Resource</a></label><ul><li><a href=/docs/plugins/dyn-resource/scaphandre/>Scaphandre</a></li></ul></li><li><input type=checkbox id=section-b19879331997b73687d0710dec8131b2 class=toggle>
<label for=section-b19879331997b73687d0710dec8131b2 class="flex justify-between"><a role=button>Dynamic Environment</a></label><ul><li><a href=/docs/plugins/dyn-environment/energy-map/>Energy Map</a></li></ul></li></ul></li><li class=book-section-flat><input type=checkbox id=section-13b92d0d0bccf417c5d521db76c99b37 class=toggle>
<label for=section-13b92d0d0bccf417c5d521db76c99b37 class="flex justify-between"><a role=button>Reference</a></label><ul><li><a href=/docs/reference/server-api/>Server API</a></li><li><a href=/docs/reference/schema/>Schema</a></li><li><a href=/docs/reference/contributing/>Contributing</a></li><li><a href=/docs/reference/development/>Development</a></li></ul></li></ul><ul><li><a href=https://github.com/leonardpahlke/carbonaut target=_blank rel=noopener>GitHub â†—</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>How to Develop Plugins</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#carbonaut-how-to-develop-plugins><strong>Carbonaut: How To Develop Plugins</strong></a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h2 id=carbonaut-how-to-develop-plugins><strong>Carbonaut: How To Develop Plugins</strong>
<a class=anchor href=#carbonaut-how-to-develop-plugins>#</a></h2><p><strong>Setup</strong>:</p><ol><li>Setup your dev environment. Follow this
<a href=/docs/guides/how-to-setup-dev-environment/>guide</a>.</li><li>Read up the
<a href=/docs/concepts/components/#provider--plugins>concepts documentation</a> about provider and plugins.</li></ol><p><strong>Identify which provider interface you need to implement</strong>:</p><ol><li>Choose the provider which is used to implement the data you like to integrate.<ol><li><code>dynres</code> implements energy usage, cpu frequency etc.</li><li><code>staticres</code> implements cloud provider, hypervisors etc. that manage your infrastructure resources.</li><li><code>dynenv</code> implements energy grid APIs</li></ol></li><li>Setup your starting point (one of these)<ol><li><code>dynres</code>: Copy the folder <code>pkg/plugin/dynresplugins/mockenergy</code> and rename it to your plugins name</li><li><code>staticres</code>: Copy the folder <code>pkg/plugin/staticresplugins/mockcloudplugin</code> and rename it to your plugins name</li><li><code>dynenv</code>: Copy the folder <code>pkg/plugin/dynenvplugins/mockenergymix</code> and rename it to your plugins name</li></ol></li><li>Implement the provider. Add unit, integration and optional end to end testing.<ol><li>Make sure to add the provider reference to the plugin file:<ol><li>For <code>dynres</code> add it to <code>pkg/plugin/dynresplugins/dynresplugins.go</code></li><li>For <code>staticres</code> add it to <code>pkg/plugin/staticresplugins/staticresplugins.go</code></li><li>For <code>dynenv</code> add it to <code>pkg/plugin/dynenvplugins/dynenvplugins.go</code></li></ol></li></ol></li><li>If applicable add caching.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>p</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>cache</span>     <span style=color:#f92672>*</span><span style=color:#a6e22e>cache</span>.<span style=color:#a6e22e>Cache</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>cfg</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Config</span>) (<span style=color:#a6e22e>p</span>, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Create a cache with an expiration time of 60 seconds, and which
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// purges expired items every 5 minutes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>c</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>cache</span>.<span style=color:#a6e22e>New</span>(<span style=color:#ae81ff>60</span><span style=color:#f92672>*</span><span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Second</span>, <span style=color:#ae81ff>5</span><span style=color:#f92672>*</span><span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Minute</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>reqData</span>(<span style=color:#a6e22e>id</span> <span style=color:#66d9ef>string</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>Data</span>, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>cachedData</span>, <span style=color:#a6e22e>found</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>cache</span>.<span style=color:#a6e22e>Get</span>(<span style=color:#a6e22e>id</span>); <span style=color:#a6e22e>found</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>cachedData</span>, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>cache</span>.<span style=color:#a6e22e>Add</span>(<span style=color:#a6e22e>id</span>, <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>cache</span>.<span style=color:#a6e22e>DefaultExpiration</span>); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>errors</span>.<span style=color:#a6e22e>New</span>(<span style=color:#e6db74>&#34;unable to add data to internal cache&#34;</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><ol start=5><li>Push changes and open a PR to propose merging changes to Carbonaut. See
<a href=/docs/reference/contributing/>contribution guide</a>.</li></ol></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/leonardpahlke/carbonaut/docs/content/docs/guides/how-to-develop-plugins.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#carbonaut-how-to-develop-plugins><strong>Carbonaut: How To Develop Plugins</strong></a></li></ul></li></ul></nav></div></aside></main></body></html>