<!doctype html><html lang=en-us dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=8081&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Carbonaut Components # Carbonaut&rsquo;s internal components are explained in this document. At a high level, Carbonaut serves metrics and integration functionallity over a server component which calls endpoints in the connector to collect metrics. The connector is the central component which controls the main application life cycle, it inhales the logic registering plugins and managing state. Plugins implement providers which deliver different kinds of data which is required to get the holistic overview of cloud native environmental sustainability."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://localhost:8081/docs/concepts/components/"><meta property="og:site_name" content="Carbonaut Docs"><meta property="og:title" content="Carbonaut Docs"><meta property="og:description" content="Carbonaut Components # Carbonaut&amp;rsquo;s internal components are explained in this document. At a high level, Carbonaut serves metrics and integration functionallity over a server component which calls endpoints in the connector to collect metrics. The connector is the central component which controls the main application life cycle, it inhales the logic registering plugins and managing state. Plugins implement providers which deliver different kinds of data which is required to get the holistic overview of cloud native environmental sustainability."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>Components | Carbonaut Docs</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=canonical href=http://localhost:8081/docs/concepts/components/><link rel=stylesheet href=/book.min.309b7ed028807cdb68d8d61e26d609f48369c098dbf5e4d8c0dcf4cdf49feafc.css integrity="sha256-MJt+0CiAfNto2NYeJtYJ9INpwJjb9eTYwNz0zfSf6vw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.75c891a37158c1b7afb5e05882626f7d7d679a123e15cde274772612caab4563.js integrity="sha256-dciRo3FYwbevteBYgmJvfX1nmhI+Fc3idHcmEsqrRWM=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/logo.png alt=Logo><span>Carbonaut Docs</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li class=book-section-flat><span>Concepts</span><ul><li><a href=/docs/concepts/components/ class=active>Components</a></li><li><a href=/docs/concepts/advanced/>Advanced</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-6de00f26ce90647f7385eb3988a66aff class=toggle>
<label for=section-6de00f26ce90647f7385eb3988a66aff class="flex justify-between"><a role=button>Guides</a></label><ul><li><a href=/docs/guides/how-to-run/>How to Run</a></li><li><a href=/docs/guides/how-to-setup-dev-environment/>How to Setup Dev Environment</a></li><li><a href=/docs/guides/how-to-develop-internals/>How to Develop Internals</a></li><li><a href=/docs/guides/how-to-develop-plugins/>How to Develop Plugins</a></li><li><a href=/docs/guides/how-to-test-e2e/>How to Test E2E</a></li></ul></li><li class=book-section-flat><input type=checkbox id=section-b78b00acf537e50586ae380e7fd00f43 class=toggle>
<label for=section-b78b00acf537e50586ae380e7fd00f43 class="flex justify-between"><a role=button>Plugins</a></label><ul><li><input type=checkbox id=section-d0cbdedebe36dd056e11e5faab06b3c9 class=toggle>
<label for=section-d0cbdedebe36dd056e11e5faab06b3c9 class="flex justify-between"><a role=button>Static Resource</a></label><ul><li><a href=/docs/plugins/static-resource/equinix/>Equinix</a></li></ul></li><li><input type=checkbox id=section-b4ac4c3f9d54889817d33ba70b2fbcaf class=toggle>
<label for=section-b4ac4c3f9d54889817d33ba70b2fbcaf class="flex justify-between"><a role=button>Dynamic Resource</a></label><ul><li><a href=/docs/plugins/dyn-resource/scaphandre/>Scaphandre</a></li></ul></li><li><input type=checkbox id=section-b19879331997b73687d0710dec8131b2 class=toggle>
<label for=section-b19879331997b73687d0710dec8131b2 class="flex justify-between"><a role=button>Dynamic Environment</a></label><ul><li><a href=/docs/plugins/dyn-environment/energy-map/>Energy Map</a></li></ul></li></ul></li><li class=book-section-flat><input type=checkbox id=section-13b92d0d0bccf417c5d521db76c99b37 class=toggle>
<label for=section-13b92d0d0bccf417c5d521db76c99b37 class="flex justify-between"><a role=button>Reference</a></label><ul><li><a href=/docs/reference/server-api/>Server API</a></li><li><a href=/docs/reference/schema/>Schema</a></li><li><a href=/docs/reference/contributing/>Contributing</a></li><li><a href=/docs/reference/development/>Development</a></li></ul></li></ul><ul><li><a href=https://github.com/leonardpahlke/carbonaut target=_blank rel=noopener>GitHub â†—</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Components</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#carbonaut-components><strong>Carbonaut Components</strong></a><ul><li><a href=#server>Server</a></li><li><a href=#connector>Connector</a></li><li><a href=#provider--plugins>Provider & Plugins</a></li></ul></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h2 id=carbonaut-components><strong>Carbonaut Components</strong>
<a class=anchor href=#carbonaut-components>#</a></h2><p>Carbonaut&rsquo;s internal components are explained in this document. At a high level, Carbonaut serves metrics and integration functionallity over a server component which calls endpoints in the connector to collect metrics. The connector is the central component which controls the main application life cycle, it inhales the logic registering plugins and managing state. Plugins implement providers which deliver different kinds of data which is required to get the holistic overview of cloud native environmental sustainability.</p><p><img src=/docs/concepts/context.drawio.png alt="carbonaut context"></p><p>The next sections will focus on each building block as well as the data schema.</p><h3 id=server>Server
<a class=anchor href=#server>#</a></h3><p>The Carbonaut Server hosts an HTTP server which serves collected metrics and serves an access point to configure the deployment at runtime. Detailed information can be found in the
<a href=/docs/reference/server-api/>api documentation</a>. As of now the server exposes metrics in <code>json</code> format. These metrics could be mapped to
<a href=https://prometheus.io/docs/concepts/metric_types/>prometheus metric types</a> down the road for better integration in the cloud native ecosystem.</p><h3 id=connector>Connector
<a class=anchor href=#connector>#</a></h3><p>At a higher level, Carbonaut integrates data over providers, and exposes collected data over a server (see
<a href=/docs/reference/server-api/>Server API docs</a>). Between these two components is the <strong>Connector</strong> component which contains the main lifecycle of the system.</p><p><img src=/docs/concepts/building-blocks.drawio.png alt="carbonaut building blocks"></p><h4 id=internal-runtime>Internal Runtime
<a class=anchor href=#internal-runtime>#</a></h4><p>The connector, parses the configuration, starts and stopps plugins, updates the local state which contains the topology of the IT infrastructure and collects data from all connected providers which the API server exposes in different formats. A simplified version of the runtime is visualized below.</p><script src=/mermaid.min.js></script><script>mermaid.initialize({flowchart:{useMaxWidth:!0},theme:"default"})</script><p class="mermaid optional">sequenceDiagram
autonumber
actor A as Alice the Platform Engineer
actor J as John the DevOps Engineer
participant CMain as Carbonaut CMD
participant CServer as Carbonaut Server
participant CConn as Carbonaut Connector
participant EInfra as Infrastructure Data Sources
participant EEnv as Environment Data Sources
A->>CMain: Start Carbonaut
activate CMain
CMain->>CConn: Run (main lifecycle)
activate CConn
CMain->>CServer: Start Listening
activate CServer
A-->>CServer: Update Configuration file
Note over CConn,EInfra: Carbonaut syncronizes the static resource state of<br>the infrastructure and maintains a mirrored state
note right of CConn: Look up configuration file
note right of CConn: Update State with Accounts
par [Mirror Static Resource & Environment Data]
        loop
  activate CConn
note right of CConn: Parse configured 'Accounts'<br>(new, old and remaining)
CConn->>EInfra: Discover 'Projects'<br>(new, old and remaining)
note right of CConn: Update State with Projects
loop
CConn->>EInfra: Discover 'Resources' by 'Project'<br>(new, old and remaining)
note right of CConn: Update State with Resources
end
deactivate CConn
end
and [Serve Static & Dynamic Data]
        J->>CServer: I would like to get Carbonaut's metrics
activate J
activate CServer
note right of CServer: Serve from Cache if set
CServer->>CConn: Collect Static and Dynamic Data
activate CConn
loop Over all Accounts
loop Over all Projects
loop Over all Resources
CConn->>EInfra: Collect Dynamic Data<br>of the resource (dynres)
activate EInfra
EInfra-->>CConn: Energy Usage and CPU Frequency data
deactivate EInfra
CConn->>EEnv: Collect Dynamic Data (dynenv)
activate EEnv
EEnv-->>CConn: Energy Mix data
deactivate EEnv
end
end
end
note right of CConn: Collected dynamic data for each resource
note right of CConn: Use static data from state
CConn-->>CServer: Return Dynamic and Static Data
deactivate CConn
CServer-->>J: Visualize state data
deactivate J
note right of CServer: Update Cache
deactivate CServer
end
deactivate CConn
deactivate CServer
CMain-->>A: Carbonaut Stopped
deactivate CMain</p><h3 id=provider--plugins>Provider & Plugins
<a class=anchor href=#provider--plugins>#</a></h3><p>Carbonaut collects data of your infrastructure over data providers. Providers are interfaces which are implemented as plugins (see Plugin section in the sidebar). There are three different kinds of providers:</p><ul><li><code>Dynamic Environment Provider</code> collects data about the Energy Mix (may be extended).</li><li><code>Dynamic Resource Provider</code> collects data about Energy Usage, CPU Frequency etc. (may be extended).</li><li><code>Static Resource Provider</code> collects data about CPU, Memory, IP etc. and also data about the geolocation and region of the IT resource.</li></ul><div class="book-columns flex flex-wrap"><div class="flex-even markdown-inner"><p class="mermaid optional">classDiagram
direction LR
ResourceData <|-- EnergyMixData : energymix data depends on location \n data which is part of resource data
ResourceData <|-- UtilizationData : utilization data depends \n on resource data
class EnergyMixData{
+SolarPercentage
+CoalPercentage
+...
}
class UtilizationData{
+CPUFrequency
+EnergyUsage
+...
}
class ResourceData{
+CPUCores
+IP
+Country
+...
}
style EnergyMixData fill:#D5E8D4
style ResourceData fill:#DAE8FC
style UtilizationData fill:#DAE8FC</p></div><div class="flex-even markdown-inner"><img src=/docs/concepts/data-domain-structure.drawio.png alt="carbonaut data domain structure"></div></div><p>These providers depend on each other. To collect energy usage of a system you first need to be aware of the system&rsquo;s topology. In the cloud environment we have heterogenous systems which changes dynamically. Therefore Resources are captured in projects (like K8s namespace&rsquo;s) and accounts (like K8s cluster&rsquo;s). The static resource provider just references the account and further discovery of projects and resources are done at runtime.</p><p>Providers expose interfaces which are defined in the schema reference document. The
<a href=/docs/reference/schema/#type-provider><code>dynenv</code> provider</a> integrates
<a href=/docs/reference/schema/#type-dynamicenvdata>data</a> about the energy mix. The
<a href=/docs/reference/schema/#type-provider-1><code>dynres</code> provider</a> integrates
<a href=/docs/reference/schema/#type-dynamicresdata>data</a> umong other things about energy usage. The
<a href=/docs/reference/schema/#type-provider-2><code>staticres</code> provider</a> integrates
<a href=/docs/reference/schema/#type-staticresdata>data</a> umong other things about Operating System, Memory, Region.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/leonardpahlke/carbonaut/docs/content/docs/concepts/components.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#carbonaut-components><strong>Carbonaut Components</strong></a><ul><li><a href=#server>Server</a></li><li><a href=#connector>Connector</a></li><li><a href=#provider--plugins>Provider & Plugins</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>